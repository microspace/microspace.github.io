<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=1">
  <title>Game</title>

  <link rel="stylesheet" type="text/css" href="css/style_test.css">
  <link rel="stylesheet" href="css/tingle.css">


  <script type="text/javascript" src="js/lib/phaser.min.js"></script>
  <link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.min.css">
  <script src="//code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css?family=Russo+One" rel="stylesheet">
  <script type="text/javascript" src="js/lib/blockly/blockly_compressed.js"></script>
  <script type="text/javascript" src="js/lib/blockly/blocks_compressed.js"></script>
  <script type="text/javascript" src="js/lib/blockly/javascript_compressed.js"></script>
  <script type="text/javascript" src="js/lib/blockly/msg/js/ru.js"></script>
  <script type="text/javascript" src="js/lib/phaser-kinetic-scrolling-plugin.min.js"></script>
  <script type="text/javascript" src="js/lib/tingle.js"></script>
  <script type="text/javascript"  src="js/lib/platform.js"></script>
  <script type="text/javascript" src="js/config.js"></script>
  <script type="text/javascript" src="js/maze.js"></script>
  <script type="text/javascript" src="js/pegman.js"></script>
  <script type="text/javascript" src="js/game_test/Boot.js"></script>
  <script type="text/javascript" src="js/game_test/Preload.js"></script>
  <script type="text/javascript" src="js/game_test/lesson.js"></script>

  <script type="text/javascript" src="js/blocks.js"></script>
  <script type="text/javascript" src="js/game_test/main.js"></script>

</head>

<body>


        

  <div class="container">
    <div class="leftside" id='blocklyArea'>
      <div class="canvas" id="blocklyDiv" style="position: absolute"></div>
    </div>
    <div class="rightside" id="rightside">
      <div class="canvas" id="canvasContainer"></div>
    </div>
  </div>
  
  <div id="resstart" style="position: fixed; bottom: 0px; left: 0px; z-index: 2;">
    <button class="play" id="play" value="play"><i id="play" class="fa fa-play" aria-hidden="true"></i>&nbsp;<span>Запуск</span></button>
  </div>


  <xml id="toolbox" style="display: none; background-color: #4d90fe;">
    <block type="maze_up"></block>
    <block type="maze_down"></block>
    <block type="maze_left"></block>
    <block type="maze_right"></block>
    <block type="uturn"></block>
  </xml>
  <xml id="startBlocks" style="display: none">
    <block type="factory_base" deletable="false" x="10" y="20"></block>
  </xml>





  <script>

var modal = new tingle.modal({
    footer: true,
    stickyFooter: false,
    closeMethods: ['overlay', 'button', 'escape'],
    closeLabel: "Close",
    cssClass: ['custom-class-1', 'custom-class-2'],
    onOpen: function() {
        console.log('modal open');
    },
    onClose: function() {
        console.log('modal closed');
    },
    beforeClose: function() {
        // here's goes some logic
        // e.g. save content before closing the modal
        // return true; // close the modal
        // return false; // nothing happens
    }
});
modal.addFooterBtn('ОК', 'tingle-btn tingle-btn--primary', function() {
                        // here goes some logic
                        modal.close();
                    })



    var options = {
      comments: true,
      collapse: true,
      disable: true,
      maxBlocks: Infinity,
      oneBasedIndex: true,
      readOnly: false,
      //rtl: false,
      //scrollbars: true,
      trashcan: true,
      //toolbox: null,
      horizontalLayout: false,
      toolboxPosition: 'start',
      zoom: {
        controls: true,
        wheel: false,
        startScale: 0.8,
        maxScale: 4,
        minScale: 0.25,
        scaleSpeed: 1.1
      }
    };
    var scene;
    var blocklyArea = document.getElementById('blocklyArea');

    var blocklyDiv = document.getElementById('blocklyDiv');
    options.toolbox = toolbox;
    var workspace = Blockly.inject(blocklyDiv, options);
    Blockly.BlockSvg.START_HAT = true;
    Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'), workspace);
    workspace.addChangeListener(Blockly.Events.disableOrphans);
    var onresize = function (e) {
      // Compute the absolute coordinates and dimensions of blocklyArea.
      var element = blocklyArea;
      var x = 0;
      var y = 0;
      do {
        x += element.offsetLeft;
        y += element.offsetTop;
        element = element.offsetParent;
      } while (element);
      // Position blocklyDiv over blocklyArea.
      blocklyDiv.style.left = x + 'px';
      blocklyDiv.style.top = y + 'px';
    
      blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
      blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
      Blockly.svgResize(workspace);
    };
    window.addEventListener('resize', onresize, false);
    onresize();
    Blockly.svgResize(workspace);
    $("#resstart").css({ "z-index": 20 });
    $("#resstart").css({ "bottom": '0px' });
  </script>
</body>

</html>